try{(window["WAFQualtricsWebpackJsonP-cloud-1.90.0"]=window["WAFQualtricsWebpackJsonP-cloud-1.90.0"]||[]).push([[14],{22:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n(24);var i=window.QSI.EmbeddedData},24:function(e,t,n){QSI.EmbeddedData&&!window.QTest||(QSI.EmbeddedData={getHTMLFromDOM:function(e){var t=QSI.util.$(e),n="";if(t)switch(t.tagName){case"TEXTAREA":case"INPUT":n=t.value;break;default:n=t.innerHTML}return n},getDataLayerVal:function(e){var t=window.QSI.InitializeDataLayerHelper().get(e);return t&&"object"==typeof t&&(t=JSON.stringify(t)),t||""},getCookieVal:function(e){var t="",n=QSI.cookie.get(e);return n&&(t=n),t},getURLParameter:function(e){return QSI.util.getQueryParam(window.location.href,e)},getURLRegexMatch:function(e){var t=e.match(/^\/(.*)\/([gim]*)/);return(t=t&&t[1]?window.location.href.match(new RegExp(t[1],t[2])):window.location.href.match(new RegExp(e)))&&t[1]?t[1]:""},getAdobeMarketingCloudIDJson:function(e){var t="";try{var n=Visitor.getInstance(e).getMarketingCloudVisitorID();t=JSON.stringify({marketingCloudVisitorID:n})}catch(e){QSI.dbg.e(e)}return t},getJavaScriptValue:function(e){var t="";try{if("object"==typeof e&&(e=e.toString()),QSI.global.enableJSSanitization||void 0===QSI.doEvalJS)return QSI.config&&!0===QSI.config.enableSecureVariables?t=QSI.strToVal(e):QSI.dbg.e("Error: JavaScript Evaluation has been disabled. Attempted to execute: '"+e+"'"),t;t=QSI.doEvalJS(e)}catch(e){QSI.dbg.e(e)}return t},getHistory:function(){return QSI.history.get()},getTimeOnSite:function(){return QSI.history.getTimeOnSite()},getCurrentPage:function(){return decodeURI(this.getWindowLocation())},getWindowLocation:function(){return window.location},getReferer:function(){return QSI.history.getPageReferrer()},getSiteReferer:function(){return QSI.history.getSiteReferrer()},getSearchTerm:function(){return QSI.history.getSearch()},getPageCount:function(){return QSI.history.getPageCount().unique},getTotalPageCount:function(){return QSI.history.getPageCount().total},getPercentagePageViewed:function(){return QSI.history.getPageCount().unique},getSiteInterceptID:function(){return this.siid},getCreativeID:function(){if(QSI.global.intercepts[this.siid]&&QSI.global.intercepts[this.siid].CreativeID)return QSI.global.intercepts[this.siid].CreativeID},getEventTrackingData:function(e){return QSI.EventTracker.get(e)},getSiteCatalystValue:function(e){for(var t,n=e.split("."),i=QSI.adobeVar.split("."),s=window,r=0;r<i.length;r++)s=s[i[r]];if(0===e.indexOf("event")&&s){var o=e+"=",a=s.events;if(a)for(var c=a.split(","),u=0;u<c.length;u++){var d=c[u],h=d.indexOf(o);if(~h)return d.substring(h+o.length,d.length)}}u=0;for(var l=n.length;u<l;u++){if(s)s=s[(t=n[u]).charAt(0).toLowerCase()+t.slice(1)]||s[n[u]]}return s||""},getUserAgent:function(){return navigator.userAgent},getBrowser:function(){return QSI.Browser.name},getBrowserVersion:function(){return QSI.Browser.version},getOperatingSystem:function(){return QSI.OS.name},getDeviceType:function(){return QSI.Browser.isMobile?"Mobile":"Desktop"},getEmbeddedData:function(e,t){t=t||[],QSI.ed[e]&&(t=t.concat(QSI.ed[e])),this.siid=e;const n=this.generateDynamicEmbeddedData(t);return window.QSI.SR&&window.QSI.SR.isOn()&&(n.Q_SR_ID=window.QSI.SR.getId(),n.Q_SR_PlaybackUrl=window.QSI.SR.getPlaybackUrl()),n},getUrlWithEmbeddedData:function(e){var t=e.url,n=e.targetType,i=e.requestId,s=e.interceptId,r=e.ed,o=e.creativeType,a=e.usingPopUnderTarget;if(!t)return"";var c=[QSI.util.creativeTypes.POP_UNDER],u=QSI.util.usePostToStart(n)&&!QSI.util.arrIncludes(c,o)&&!a;const d=this.getEmbeddedData(s,r);var h=d.Q_TS_ID&&d.Q_TS_RS&&d.Q_EE_ANON?{Q_TS_ID:d.Q_TS_ID,Q_TS_RS:d.Q_TS_RS,Q_EE_ANON:d.Q_EE_ANON}:{},l=u?h:d;return this.mergeEmbeddedDataIntoURL(t,l,i,s,u)},getEmbeddedDataAsArray:function(e,t,n){var i=[],s=this.getEmbeddedData(e,n);for(var r in s){n={key:r,value:s[r]};i.push(n)}var o=this.generateQTouchpoint(t,e);if(o){n={key:"Q_Touchpoint",value:o};i.push(n)}return i},mergeEmbeddedDataIntoURL:function(e,t,n,i,s){var r,o;if(-1!==e.indexOf("?")){var a=e.split("?");r=a[0],o=this.getQueryParamsObjectFromString(a[1])}else r=e,o={};for(var c in t)o[c]=t[c];if(!s){var u=this.generateQTouchpoint(n,i);u&&(o.Q_Touchpoint=u)}var d=QSI.util.buildQueryString(o);return d?r+"?"+d:r},generateQTouchpoint:function(e,t){var n;if(e&&window.QSI.Request[e]&&t&&window.QSI.Request[e].Intercepts[t]){var i=window.QSI.Request[e].Intercepts[t].Targeting;i.ContactID&&i.DistributionID&&i.DirectoryID&&(n=i.DistributionID+"_"+i.ContactID+"_"+i.DirectoryID)}return n},getQueryParamsObjectFromString:function(e){var t={};if(!e)return t;for(var n=e.split("&"),i=0;i<n.length;i++){var s=n[i].split("=");t[s[0]]=s[1]}return t},getEmbeddedDataAsQueryStringParam:function(e,t){var n=this.getEmbeddedData(e,t);return 0===Object.keys(n).length?"":QSI.util.buildQueryString(n)},generateDynamicEmbeddedData:function(e){QSI.dbg.log("SI-4479 generateDynamicEmbeddedData start of function.  QSI.ed: "+JSON.stringify(QSI.ed)+"  ed: "+JSON.stringify(e));var t={};"string"==typeof e&&(e=e.split(""));for(var n=0,i=e.length;n<i;n++)try{var s=e[n];if(s.type&&s.name){var r="";switch(s.type){case"StaticVal":r=s.value;break;case"HTML":r=this.getHTMLFromDOM(s.value);break;case"Cookie":r=this.getCookieVal(s.value);break;case"QueryParam":r=this.getURLParameter(s.value);break;case"URLRegex":r=this.getURLRegexMatch(s.value);break;case"JavaScriptVal":r=this.getJavaScriptValue(s.value);break;case"SiteCatalyst":r=this.getSiteCatalystValue(s.value);break;case"EventTracking":r=this.getEventTrackingData(s.value);break;case"AdobeOrgID":r=this.getAdobeMarketingCloudIDJson(s.value);break;case"GoogleDataLayer":window.QSI.global.featureFlags["DX.GoogleDataLayer"]&&(r=this.getDataLayerVal(s.value));break;default:this["get"+s.type]?r=this["get"+s.type](s.value):0===s.value.indexOf("JSON.stringify")&&-1!==s.value.indexOf("marketingCloudVisitorID")?(QSI.dbg.log("SI-4479 generateDynamicEmbeddedData Attempting default case getJavaScriptValue fix. QSI.ed: "+JSON.stringify(QSI.ed)+"  set: "+JSON.stringify(s)),r=this.getJavaScriptValue(s.value)):(QSI.dbg.log("SI-4479 generateDynamicEmbeddedData Final else case in default QSI.ed: "+JSON.stringify(QSI.ed)+"  set: "+JSON.stringify(s)),r=s.value)}"XMDContactED"!==s.type&&(r=String(r),t[s.name]=r)}}catch(e){QSI.dbg.e(e)}return t}})},64:function(e,t,n){"use strict";n.r(t);var i,s=n(45);!function(e){e.FullSnapshot="FullSnapshot",e.PageChanged="PageChanged",e.SignalCaptured="SignalCaptured",e.ChunkEndMarker="ChunkEndMarker"}(i||(i={}));var r,o,a=function(){function e(){}return e.prototype.generateTimelineEvent=function(e,t){var n=void 0,r=void 0;switch(e.type){case s.EventType.FullSnapshot:n=i.FullSnapshot;break;case s.EventType.Meta:n=i.PageChanged,r={href:e.data.href};break;case s.EventType.Custom:n=i.SignalCaptured,r={signalId:e.data.tag,signalSlot:null};break;default:return null}return{eventKey:{type:n,timestamp:e.timestamp},chunkNumber:t,eventDetails:r}},e.prototype.pushChunkEndMarker=function(e,t,n){e.push({eventKey:{type:i.ChunkEndMarker,timestamp:t},chunkNumber:n})},e}(),c=n(26),u=function(){function e(){}return e.prototype.startListening=function(e){window.triggerExampleSignal=function(t){e(t,{exampleMetadatKey:"exampleMetadataValue"}),console.log("example signal recorded")}},e.prototype.stopListening=function(){window.triggerExampleSignal=null},e}(),d=function(){function e(){this.isListening=!1}return e.prototype.startListening=function(t){this.isListening||(this.messageEventHandler=function(n){var i=n.origin,s=n.data;if((!window.QSI.Orchestrator||!window.QSI.Orchestrator.isMessageEventOriginAllowed||window.QSI.Orchestrator.isMessageEventOriginAllowed(i))&&"string"==typeof s&&s.startsWith("QualtricsEOS")){var r=s.match(/^QualtricsEOS\|(SV_[0-9a-zA-Z]{11,15})\|(FS_[0-9a-zA-Z]{11,15})$/);if(r){var o=r[1],a=r[2];t(e.SURVEY_TAKEN_SIGNAL_NAME,{surveyId:o,surveySessionId:a})}}},window.addEventListener("message",this.messageEventHandler),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.removeEventListener("message",this.messageEventHandler),this.isListening=!1)},e.SURVEY_TAKEN_SIGNAL_NAME="QualtricsSurveyTaken",e}(),h=function(){function e(){var t=this;this.evaluateForRageSignal=function(n,i,s){var r={eventX:n,eventY:i,time:s},o=t.ragePressHistory.length;if(0===o)return t.ragePressHistory.push(r),void(t.isRageStreak=!1);var a=t.ragePressHistory[o-1];t.arePressesCloseTogether(a,r)?(t.ragePressHistory.push(r),t.ragePressHistory.length>=e.NUM_CLICKS_THRESHOLD&&!t.isRageStreak&&(t.isRageStreak=!0,t.recordSignalCallback(e.RAGE_CLICK_SIGNAL_NAME,{}))):(t.isRageStreak=!1,t.ragePressHistory=[r])},this.rageClickListenerFn=function(e){t.evaluateForRageSignal(e.clientX,e.clientY,performance.now())},this.rageTapListenerFn=function(e){t.evaluateForRageSignal(e.clientX,e.clientY,performance.now())},this.arePressesCloseTogether=function(t,n){return Math.abs(t.eventX-n.eventX)<=e.PIXELS_BETWEEN_CLICKS_THRESHOLD&&Math.abs(t.eventY-n.eventY)<=e.PIXELS_BETWEEN_CLICKS_THRESHOLD&&Math.abs(t.time-n.time)<=e.MS_BETWEEN_CLICKS_THRESHOLD},this.isListening=!1}return e.prototype.startListening=function(e){this.isListening||(this.ragePressHistory=[],this.recordSignalCallback=e,window.QSI.Browser.isMobile?window.addEventListener("pointerup",this.rageTapListenerFn):window.addEventListener("click",this.rageClickListenerFn),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.removeEventListener("click",this.rageClickListenerFn),window.removeEventListener("pointerup",this.rageTapListenerFn),this.isListening=!1)},e.RAGE_CLICK_SIGNAL_NAME="RageClick",e.NUM_CLICKS_THRESHOLD=4,e.MS_BETWEEN_CLICKS_THRESHOLD=300,e.PIXELS_BETWEEN_CLICKS_THRESHOLD=200,e}(),l=function(){function e(){var t=this;this.errorListenerFn=function(){t.pressEvent&&t.recordSignalCallback(e.ERROR_PRESS_SIGNAL_NAME,{})},this.clickListenerFn=function(){t.pressEvent=!0,t.pressTimeout&&clearTimeout(t.pressTimeout),t.pressTimeout=window.setTimeout(t.resetPressEvent,e.ERROR_CLICK_MS_THRESHOLD)},this.tapListenerFn=function(){t.pressEvent=!0,t.pressTimeout&&clearTimeout(t.pressTimeout),t.pressTimeout=window.setTimeout(t.resetPressEvent,e.ERROR_TAP_MS_THRESHOLD)},this.resetPressEvent=function(){t.pressEvent=!1},this.isListening=!1,this.pressEvent=!1}return e.prototype.startListening=function(e){this.isListening||(this.recordSignalCallback=e,window.QSI.Browser.isMobile?window.addEventListener("pointerup",this.tapListenerFn,!0):window.addEventListener("click",this.clickListenerFn,!0),window.addEventListener("error",this.errorListenerFn),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(this.pressEvent=null,window.removeEventListener("click",this.clickListenerFn,!0),window.removeEventListener("pointerup",this.tapListenerFn,!0),window.removeEventListener("error",this.errorListenerFn),clearTimeout(this.pressTimeout),this.isListening=!1,this.pressEvent=!1)},e.ERROR_PRESS_SIGNAL_NAME="ErrorClick",e.ERROR_CLICK_MS_THRESHOLD=50,e.ERROR_TAP_MS_THRESHOLD=500,e}(),g=function(){function e(){var t=this;this.detectThrashing=function(){var n=window.QSI.Browser.isMobile,i=n?t.detectTouchThrashing():t.detectMouseThrashing();i&&!t.isThrashing&&(t.recordSignalCallback(e.THRASH_SIGNAL_NAME,{}),t.isThrashing=!0),i||(t.isThrashing=!1),n||(t.xDistance=0,t.yDistance=0,t.xDirectionChangeCount=0,t.yDirectionChangeCount=0)},this.detectMouseThrashing=function(){var n=t.xDistance/e.INTERVAL_MS,i=t.yDistance/e.INTERVAL_MS;return(t.xDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD||t.yDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD)&&(n>=e.VELOCITY_THRESHOLD||i>=e.VELOCITY_THRESHOLD)},this.detectTouchThrashing=function(){var n=!1;if(t.trackedTouch&&!t.trackedTouch.hasThrashed){var i=t.trackedTouch.xDistance/e.INTERVAL_MS,s=t.trackedTouch.yDistance/e.INTERVAL_MS;(t.trackedTouch.xDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD||t.trackedTouch.yDirectionChangeCount>=e.NUM_DIRECTION_CHANGES_THRESHOLD)&&(i>=e.VELOCITY_THRESHOLD||s>=e.VELOCITY_THRESHOLD)&&(n=!0,t.trackedTouch.hasThrashed=!0)}return n},this.mouseListenerFn=function(e){var n=Math.sign(e.movementX),i=Math.sign(e.movementY);t.xDistance+=Math.abs(e.movementX),t.yDistance+=Math.abs(e.movementY),0!=n&&n!==t.xDirection&&(t.xDirection=n,t.xDirectionChangeCount++),0!=i&&i!==t.yDirection&&(t.yDirection=i,t.yDirectionChangeCount++)},this.dragListenerFn=function(e){var n={movementX:e.clientX-t.xDragPosition,movementY:e.clientY-t.yDragPosition};t.xDragPosition=e.clientX,t.yDragPosition=e.clientY,t.mouseListenerFn(n)},this.touchStartListenerFn=function(e){if(!t.trackedTouch){var n=e.changedTouches[0],i=n.identifier,s=n.pageX,r=n.pageY;t.trackedTouch={id:i,currentX:s,currentY:r,xDistance:0,yDistance:0,xDirection:0,yDirection:0,xDirectionChangeCount:0,yDirectionChangeCount:0,hasThrashed:!1}}},this.touchMoveListenerFn=function(e){if(t.trackedTouch){var n=Array.from(e.changedTouches).find((function(e){var n=e.identifier;return t.trackedTouch.id===n}));if(n){var i=n.pageX,s=n.pageY,r=i-t.trackedTouch.currentX,o=s-t.trackedTouch.currentY,a=Math.sign(r),c=Math.sign(o);t.trackedTouch.xDistance+=Math.abs(r),t.trackedTouch.yDistance+=Math.abs(o),0!=a&&a!==t.trackedTouch.xDirection&&(t.trackedTouch.xDirection=a,t.trackedTouch.xDirectionChangeCount++),0!=c&&c!==t.trackedTouch.yDirection&&(t.trackedTouch.yDirection=c,t.trackedTouch.yDirectionChangeCount++),t.trackedTouch.currentX=i,t.trackedTouch.currentY=s}}},this.touchEndListenerFn=function(e){t.trackedTouch&&(Array.from(e.changedTouches).find((function(e){var n=e.identifier;return t.trackedTouch.id===n}))&&(t.trackedTouch=null))},this.isListening=!1}return e.prototype.startListening=function(t){this.isListening||(this.recordSignalCallback=t,this.xDirectionChangeCount=0,this.yDirectionChangeCount=0,this.xDistance=0,this.yDistance=0,this.xDragPosition=0,this.yDragPosition=0,this.thrashInterval=window.setInterval(this.detectThrashing,e.INTERVAL_MS),this.isThrashing=!1,window.QSI.Browser.isMobile?(window.addEventListener("touchstart",this.touchStartListenerFn),window.addEventListener("touchmove",this.touchMoveListenerFn),window.addEventListener("touchend",this.touchEndListenerFn),window.addEventListener("touchcancel",this.touchEndListenerFn)):(window.addEventListener("mousemove",this.mouseListenerFn),window.addEventListener("dragover",this.dragListenerFn)),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.clearInterval(this.thrashInterval),window.removeEventListener("mousemove",this.mouseListenerFn),window.removeEventListener("dragover",this.dragListenerFn),window.removeEventListener("touchstart",this.touchStartListenerFn),window.removeEventListener("touchmove",this.touchMoveListenerFn),window.removeEventListener("touchend",this.touchEndListenerFn),window.removeEventListener("touchcancel",this.touchEndListenerFn),this.isListening=!1,this.isThrashing=!1)},e.THRASH_SIGNAL_NAME="MouseThrash",e.INTERVAL_MS=500,e.VELOCITY_THRESHOLD=2,e.NUM_DIRECTION_CHANGES_THRESHOLD=3,e}(),S=function(){function e(){var t=this;this.mutationCallback=function(){window.clearTimeout(t.deadClickObserverTimeoutID),t.deadClickObserver.disconnect(),t.isObserving=!1,window.removeEventListener("scroll",t.evaluateForScroll,!1)},this.mutationTimeoutCallback=function(){t.deadClickObserver.disconnect(),t.recordSignalCallback(e.DEAD_CLICK_SIGNAL_NAME,{}),t.isObserving=!1,window.removeEventListener("scroll",t.evaluateForScroll,!1)},this.evaluateForDeadClick=function(n){var i=n.target;!t.isObserving&&t.canElementBeDeadClicked(i)&&(t.startYPosition=window.scrollY,window.addEventListener("scroll",t.evaluateForScroll,!1),t.isObserving=!0,t.deadClickObserver.observe(document.body,e.DEAD_CLICK_OBSERVER_CONFIG),t.deadClickObserverTimeoutID=window.setTimeout(t.mutationTimeoutCallback,e.DEAD_CLICK_OBSERVER_TIMEOUT))},this.evaluateForScroll=function(e){e.currentTarget.scrollY!==t.startYPosition&&t.mutationCallback()},this.canElementBeDeadClicked=function(e){var n=e.nodeName.toUpperCase();return t.isElementInAllowlist(e,n)||t.isDeadClickableAnchorTag(e,n)},this.isElementInAllowlist=function(t,n){var i=t.role,s=i?i.toUpperCase():null;return e.DEAD_CLICK_ALLOWLIST.has(n)||e.DEAD_CLICK_ALLOWLIST.has(s)},this.isNotHTTPSProtocol=function(e){var t=document.createElement("a");t.href=e.href;var n=t.protocol;return"https:"!==n&&"http:"!==n},this.isDownloadable=function(e){return void 0!==e.download},this.isDeadClickableAnchorTag=function(e,n){if("A"!==n||t.isNotHTTPSProtocol(e)||t.isDownloadable(e))return!1;if(!e.href)return!0;var i=e.target;return i?"_blank"!==i:!t.openNewTabByDefault},this.deadClickSignalListenerFn=function(e){t.evaluateForDeadClick(e)},this.isListening=!1,this.startYPosition=window.scrollY;var n=document.querySelector("base"),i=!!n&&n.target;this.openNewTabByDefault=!!i&&"_blank"===i.toLowerCase()}return e.prototype.startListening=function(e){this.isListening||(this.isObserving=!1,this.recordSignalCallback=e,this.deadClickObserver=new MutationObserver(this.mutationCallback),window.QSI.Browser.isMobile?window.addEventListener("pointerup",this.deadClickSignalListenerFn,!0):window.addEventListener("click",this.deadClickSignalListenerFn,!0),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(window.removeEventListener("pointerup",this.deadClickSignalListenerFn,!0),window.removeEventListener("click",this.deadClickSignalListenerFn,!0),this.isListening=!1,this.isObserving=!1,window.clearTimeout(this.deadClickObserverTimeoutID),this.deadClickObserverTimeoutID=null)},e.DEAD_CLICK_SIGNAL_NAME="DeadClick",e.DEAD_CLICK_ALLOWLIST=new Set(["BUTTON"]),e.DEAD_CLICK_OBSERVER_CONFIG={attributes:!0,childList:!0,subtree:!0},e.DEAD_CLICK_OBSERVER_TIMEOUT=2e3,e}(),f=function(e,t){for(var n=0,i=t.length,s=e.length;n<i;n++,s++)e[s]=t[n];return e},v=function(){function e(e){var t=this;this.customEventListenerFn=function(e){t.recordSignalCallback(t.customSignalsDictionary[e.type].signalId,{})},this.customSignalsDictionary=Object.assign.apply(Object,f([{}],e.map((function(e){var t;return(t={})[e.signalKey]=e,t})))),this.isListening=!1}return e.prototype.startListening=function(e){if(!this.isListening){for(var t in this.recordSignalCallback=e,this.customSignalsDictionary)window.addEventListener(t,this.customEventListenerFn);this.isListening=!0}},e.prototype.stopListening=function(){if(this.isListening){for(var e in this.customSignalsDictionary)window.removeEventListener(e,this.customEventListenerFn);this.isListening=!1}},e}();!function(e){e.IPAddress="IPAddress"}(r||(r={})),function(e){e.StartingUrl="StartingUrl",e.Device="Device",e.UserAgent="UserAgent",e.Referrer="Referrer",e.ExtRefId="ExtRefId",e.DirectoryId="DirectoryId"}(o||(o={}));var p=n(46),E=n(22);n.d(t,"SESSION_INIT_STATUS",(function(){return I})),n.d(t,"PLAYBACK_INGEST_STATUS",(function(){return T})),n.d(t,"SessionRecorder",(function(){return w})),n.d(t,"initSR",(function(){return L})),n.d(t,"packEvents",(function(){return y}));var I,T,m=function(){return(m=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},b=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},C=function(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},k=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};!function(e){e.THROTTLED="THROTTLED",e.SUCCESS="SUCCESS"}(I||(I={})),function(e){e.THROTTLED="THROTTLED",e.SUCCESS="SUCCESS"}(T||(T={}));var w=function(){function e(t){var n=t.brandId,i=t.brandDc,s=t.zoneId,r=t.siBaseUrl,o=t.cookieDomain,u=t.configuration,d=t.brandBaseUrl;switch(this.sessionInfo=null,this.nextChunkSequenceNumber=0,this.isInitialized=!1,this.isRecording=!1,this.isSavingToBackend=!1,this.isWindowUnloading=!1,this.playbackEvents=[],this.chunkTimeline=[],this.qsiCookieUtilities=new c.a,this.brandId=n,this.brandDc=i,this.zoneId=s,this.timelineHelper=new a,r){case"https://s1.b1-prv.qualtrics.com":this.siBaseUrl="https://sr.b1-prv.qualtrics.com";break;case"https://s1.st3.qualtrics.com":case"https://s1.g1-iad.qualtrics.com":case"https://s1.g1-cmh.qualtrics.com":this.siBaseUrl="https://sr.st3.qualtrics.com";break;default:this.siBaseUrl="https://sr.qualtrics.com"}"qpsb1"===n&&(this.siBaseUrl="https://sr.b1-prv.qualtrics.com",this.brandDc="b1-prv"),this.cookieDomain=o,this.brandBaseUrl=d,this.sessionInfoCookieName=""+e.SESSION_INFO_COOKIE_NAME_PREFIX+this.zoneId,this.sessionThrottledCookieName=""+e.SESSION_THROTTLED_COOKIE_NAME_PREFIX+this.zoneId,this.sessionSampledOutCookieName=""+e.SESSION_SAMPLEDOUT_COOKIE_NAME_PREFIX+this.zoneId,this.configuration=u}return e.prototype.validateSession=function(){return b(this,void 0,void 0,(function(){var e,t,n,i,s,r,o;return C(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),this.isInitialized?[2]:(e=this.qsiCookieUtilities.get(this.sessionInfoCookieName))?(t=JSON.parse(e),n=t.nextChunkSequenceNumber,i=k(t,["nextChunkSequenceNumber"]),s=this.siBaseUrl,this.setDatacenterBaseUrl(i),r={brandId:this.brandId,sessionId:i.sessionId},[4,this.makeValidateSessionRequest(r)]):[2];case 1:return a.sent().isValidSession?(this.initializeSessionInfo(i),this.nextChunkSequenceNumber=n):(this.qsiCookieUtilities.erase(this.sessionInfoCookieName,this.cookieDomain),this.siBaseUrl=s),[3,3];case 2:throw o=a.sent(),this.setBackOffOnUnexpectedFailure(),o;case 3:return[2]}}))}))},e.prototype.makeValidateSessionRequest=function(t){return b(this,void 0,void 0,(function(){var n;return C(this,(function(i){switch(i.label){case 0:return[4,fetch(""+this.siBaseUrl+e.SESSION_VALIDATE_API_PATH,{method:"PUT",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return n=i.sent(),[4,this.parseSessionValidateServerResponse(n)];case 2:return[2,i.sent()]}}))}))},e.prototype.notAllowedToInitialize=function(){return!!this.qsiCookieUtilities.get(this.sessionThrottledCookieName)||!!this.qsiCookieUtilities.get(this.sessionSampledOutCookieName)},e.prototype.setSampledOutBackoff=function(){this.qsiCookieUtilities.set(this.sessionSampledOutCookieName,"true",null,this.cookieDomain,{secure:!0})},e.prototype.parseSessionValidateServerResponse=function(e){return b(this,void 0,void 0,(function(){var t;return C(this,(function(n){switch(n.label){case 0:if(200!==e.status)throw new Error("Received unexpected HTTP code from call to server: "+e.status);return[4,e.json()];case 1:if("boolean"!=typeof(null==(t=n.sent())?void 0:t.isValidSession))throw new Error("Received invalid response with 200 server response: "+t.isValidSession);return[2,t]}}))}))},e.prototype.setRecordingBackoff=function(t){this.qsiCookieUtilities.set(this.sessionThrottledCookieName,"true",t/e.SECONDS_IN_A_DAY,this.cookieDomain,{secure:!0}),this.qsiCookieUtilities.erase(this.sessionInfoCookieName,this.cookieDomain)},e.prototype.initializeSessionInfo=function(e){this.sessionInfo=e,this.setDatacenterBaseUrl(this.sessionInfo),this.isInitialized=!0},e.prototype.setBackOffOnUnexpectedFailure=function(){this.setRecordingBackoff(e.BACKOFF_SECONDS_ON_UNEXPECTED_FAILURE)},e.prototype.setDatacenterBaseUrl=function(e){["a1-prv","b1-prv","g1-cmh"].includes(e.creationDataCenter)||(this.siBaseUrl="https://"+e.creationDataCenter+".sr.qualtrics.com")},e.prototype.startRecording=function(t,i){return b(this,void 0,void 0,(function(){var s,r,o,a=this;return C(this,(function(c){switch(c.label){case 0:return this.isRecording?[2]:[4,Promise.resolve().then(n.t.bind(null,45,7))];case 1:return s=c.sent().record,r=!this.configuration||this.configuration.shouldMaskInputFields,o=this.configuration?this.configuration.cssSelectorsToMask:"",this.stopsirrwebRecorder=s({emit:function(t){a.lastChunkEventTimestampEpoch=t.timestamp;var n=a.timelineHelper.generateTimelineEvent(t,a.nextChunkSequenceNumber);null!=n&&a.chunkTimeline.push(n);var s=a.playbackEvents.length,r=JSON.stringify(a.playbackEvents).length,o=JSON.stringify(t).length;if(r+o>e.PLAYBACK_EVENTS_CIRCUIT_BREAKER_THRESHOLD_BYTES)return i(new Error("Playback data accruing too fast for Zone:"+a.zoneId+". Exceeded threshold:"+e.PLAYBACK_EVENTS_CIRCUIT_BREAKER_THRESHOLD_BYTES+" bytes. Tried adding new event of "+o+" bytes to queue with "+r+" bytes ("+s+" events)Stopping recording")),a.stopRecording(),void a.setBackOffOnUnexpectedFailure();a.playbackEvents.push(t)},maskAllInputs:r,blockSelector:o}),window.setTimeout((function(){return b(a,void 0,void 0,(function(){return C(this,(function(e){switch(e.label){case 0:return[4,this.persistEventsToBackend(i)];case 1:return e.sent(),[2]}}))}))}),1e3*e.PLAYBACK_DATA_INITIAL_PERSISTENCE_SECONDS),this.saveToBackendFunctionId=window.setInterval((function(){return b(a,void 0,void 0,(function(){return C(this,(function(e){switch(e.label){case 0:return[4,this.persistEventsToBackend(i)];case 1:return e.sent(),[2]}}))}))}),1e3*e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS),this.windowBeforeUnloadListener=function(){a.isWindowUnloading=!0,clearInterval(a.saveToBackendFunctionId),a.persistEventsToBackendBeacon()},addEventListener("beforeunload",this.windowBeforeUnloadListener),this.registerSignalListeners(s.addCustomEvent,t),this.isRecording=!0,[2]}}))}))},e.prototype.registerSignalListeners=function(e,t){this.signalListeners=t,this.signalListeners.forEach((function(t){t.startListening((function(t,n){e(t,n),window.QSI.global.featureFlags["DX.PepperPotts_TestingTools"]&&console.log(t+" detected!")}))}))},e.prototype.persistEventsToBackend=function(t){return b(this,void 0,void 0,(function(){var n,i,s,r,o,a,c;return C(this,(function(u){switch(u.label){case 0:if(this.isSavingToBackend)return[2];if(0===this.playbackEvents.length)return[2];this.isSavingToBackend=!0,n=this.playbackEvents,i=this.nextChunkSequenceNumber,this.playbackEvents=[],this.nextChunkSequenceNumber++,this.timelineHelper.pushChunkEndMarker(this.chunkTimeline,this.lastChunkEventTimestampEpoch,i),u.label=1;case 1:return u.trys.push([1,7,8,9]),s=y(n),this.isInitialized?[3,3]:(r={events:s,chunkNumber:i},[4,this.createSession(r)]);case 2:return u.sent(),[3,6];case 3:return this.qsiCookieUtilities.set(this.sessionInfoCookieName,JSON.stringify(m(m({},this.sessionInfo),{nextChunkSequenceNumber:this.nextChunkSequenceNumber})),null,this.cookieDomain,{secure:!0}),[4,fetch(""+this.siBaseUrl+e.PUT_RECORD_PLAYBACK_API_PATH,{method:"PUT",headers:{"Content-Type":"application/json"},body:this.buildPersistEventRequestBody({sessionId:this.sessionInfo.sessionId,events:s,chunkNumber:i,brandDc:this.brandDc,brandId:this.brandId,zoneId:this.zoneId,chunkTimeline:this.chunkTimeline})})];case 4:return o=u.sent(),[4,this.parsePlaybackIngestionServerResponse(o)];case 5:if((a=u.sent()).status===T.THROTTLED)return this.stopRecording(),this.setRecordingBackoff(a.backOffPeriodSeconds),[2];u.label=6;case 6:return[3,9];case 7:return c=u.sent(),this.isWindowUnloading||(t(new Error("Failed to persist playback data to backend for Zone:"+this.zoneId+": "+c.toString())),this.stopRecording(),this.setBackOffOnUnexpectedFailure()),[3,9];case 8:return this.isSavingToBackend=!1,[7];case 9:return[2]}}))}))},e.prototype.persistEventsToBackendBeacon=function(){this.isInitialized&&(0!==this.playbackEvents.length&&(this.timelineHelper.pushChunkEndMarker(this.chunkTimeline,this.lastChunkEventTimestampEpoch,this.nextChunkSequenceNumber),navigator.sendBeacon(""+this.siBaseUrl+e.POST_RECORD_PLAYBACK_API_PATH,this.buildPersistEventRequestBody({sessionId:this.sessionInfo.sessionId,events:y(this.playbackEvents),chunkNumber:this.nextChunkSequenceNumber,brandDc:this.brandDc,brandId:this.brandId,zoneId:this.zoneId,chunkTimeline:this.chunkTimeline}))&&(this.nextChunkSequenceNumber++,this.qsiCookieUtilities.set(this.sessionInfoCookieName,JSON.stringify(m(m({},this.sessionInfo),{nextChunkSequenceNumber:this.nextChunkSequenceNumber})),null,this.cookieDomain,{secure:!0}))))},e.prototype.getChunkInfo=function(e){return{playbackData:e.events,playbackDataVersion:2,chunkNumber:e.chunkNumber,chunkTimeline:e.chunkTimeline}},e.prototype.createSession=function(t){return b(this,void 0,void 0,(function(){var n,i,s,o,a,c,u;return C(this,(function(d){switch(d.label){case 0:return this.isInitialized?[2]:(n=t.events,i=t.chunkNumber,s=[],o={},this.configuration.customMetadata&&this.configuration.customMetadata[0]&&(a=function(e){var t=[],n={};if(!Array.isArray(e))return[t,n];for(var i=0;i<e.length;i++){var s=e[i],o=s.metadataSourceValue,a=void 0===o?null:o,c=s.metadataName,u=s.metadataSource,d=s.metadataId;if(u in r)n[d]=u,t.push({id:d,value:u});else{var h=[{name:c,value:a,type:u}],l=E.a.generateDynamicEmbeddedData(h);t.push({id:d,value:l[c]})}}return[t,n]}(this.configuration.customMetadata),s=a[0],o=a[1]),[4,fetch(""+this.siBaseUrl+e.SESSION_CREATE_API_PATH,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:this.buildCreateSessionRequestBody({events:n,chunkNumber:i,brandDc:this.brandDc,brandId:this.brandId,zoneId:this.zoneId,chunkTimeline:this.chunkTimeline,customMetadata:s,metadata:this.getSessionMetadata(),customMetadataGeneratorMapping:o})})]);case 1:return c=d.sent(),[4,this.parseSessionInitServerResponse(c)];case 2:return(u=d.sent()).status===I.THROTTLED?(this.stopRecording(),this.setRecordingBackoff(u.backOffPeriodSeconds),[2]):(this.qsiCookieUtilities.set(this.sessionInfoCookieName,JSON.stringify(m(m({},u.sessionInfo),{nextChunkSequenceNumber:this.nextChunkSequenceNumber})),null,this.cookieDomain,{secure:!0}),this.initializeSessionInfo(u.sessionInfo),[2])}}))}))},e.prototype.parseSessionInitServerResponse=function(e){return b(this,void 0,void 0,(function(){var t;return C(this,(function(n){switch(n.label){case 0:if(200!==e.status)throw new Error("Received unexpected HTTP code from call to server: "+e.status);return[4,e.json()];case 1:switch((t=n.sent()).status){case I.THROTTLED:if(!Number.isInteger(t.backOffPeriodSeconds))throw new Error("Received invalid backOffPeriod with THROTTLED server response: "+t.backOffPeriodSeconds);return[2,t];case I.SUCCESS:if(!t.sessionInfo||"string"!=typeof t.sessionInfo.sessionId||"string"!=typeof t.sessionInfo.sessionStartTime)throw new Error("Received invalid sessionInfo with SUCCESS server response: "+t.sessionInfo);return[2,t];default:throw new Error("Received unexpected status message from server: "+status)}return[2]}}))}))},e.prototype.buildCreateSessionRequestBody=function(e){var t=e.events,n=e.chunkNumber,i=e.brandDc,s=e.brandId,r=e.zoneId,o=e.chunkTimeline,a={brandId:s,brandDc:i,zoneId:r,customMetadata:e.customMetadata,metadata:e.metadata,customMetadataGeneratorMapping:e.customMetadataGeneratorMapping,chunkInfo:this.getChunkInfo({events:t,chunkNumber:n,chunkTimeline:o})};return this.chunkTimeline=[],JSON.stringify(a)},e.prototype.buildPersistEventRequestBody=function(e){var t=e.sessionId,n=e.events,i=e.chunkNumber,s=e.brandDc,r=e.brandId,o=e.zoneId,a=e.chunkTimeline,c=this.getChunkInfo({events:n,chunkNumber:i,chunkTimeline:a}),u=m({brandDc:s,brandId:r,zoneId:o,sessionId:t},c);return this.chunkTimeline=[],JSON.stringify(u)},e.prototype.parsePlaybackIngestionServerResponse=function(e){return b(this,void 0,void 0,(function(){var t,n;return C(this,(function(i){switch(i.label){case 0:if(200!==e.status)throw new Error("Received unexpected HTTP code from call to server: "+e.status);return[4,e.json()];case 1:switch((t=i.sent()).status){case T.THROTTLED:if(n=t.backOffPeriodSeconds,!Number.isInteger(n))throw new Error("Received invalid backOffPeriodSeconds with THROTTLED server response: "+n);return[2,t];case T.SUCCESS:return[2,t];default:throw new Error("Received unexpected status message from server: "+status)}return[2]}}))}))},e.prototype.stopRecording=function(){this.isRecording&&(clearInterval(this.saveToBackendFunctionId),this.stopsirrwebRecorder(),removeEventListener("beforeunload",this.windowBeforeUnloadListener),this.playbackEvents=[],this.signalListeners.forEach((function(e){e.stopListening()})),this.isRecording=!1)},e.prototype.isSessionInitialized=function(){return this.isInitialized},e.prototype.getRecordedEvents=function(){return this.playbackEvents},e.prototype.getId=function(){return this.sessionInfo?this.sessionInfo.sessionId:null},e.prototype.getPlaybackUrl=function(){return this.sessionInfo&&this.brandBaseUrl&&this.zoneId?this.brandBaseUrl+"/siui/project/"+this.zoneId+"/sr/session/"+this.sessionInfo.sessionId:null},e.prototype.isOn=function(){return this.isRecording},e.prototype.getSessionMetadata=function(){var e=function(e){return null===e?null:(e.length>=255&&(e=e.slice(0,252)+"..."),e)},t=window.location.href,n=window.QSI.Browser.isMobile?"Mobile":"Desktop",i=window.navigator?window.navigator.userAgent:"",s=window.document.referrer?window.document.referrer:null,r=window.QSI.config.externalReference?window.QSI.config.externalReference:null,a=this.configuration.directoryId?this.configuration.directoryId:null;return[{id:o.StartingUrl,value:e(t)},{id:o.Device,value:e(n)},{id:o.UserAgent,value:e(i)},{id:o.Referrer,value:e(s)},{id:o.ExtRefId,value:e(r)},{id:o.DirectoryId,value:e(a)}]},e.prototype.doSamplingRateComparison=function(){var e=this.configuration&&this.configuration.samplingRate?this.configuration.samplingRate:0;return Math.random()<e/100},e.SESSION_INFO_COOKIE_NAME_PREFIX="QSI_ReplaySession_Info_",e.SESSION_THROTTLED_COOKIE_NAME_PREFIX="QSI_ReplaySession_Throttled_",e.SESSION_SAMPLEDOUT_COOKIE_NAME_PREFIX="QSI_ReplaySession_SampledOut_",e.SESSION_VALIDATE_API_PATH="/sr-data-ingestion-service/v1/sessions/validate",e.SESSION_CREATE_API_PATH="/sr-data-ingestion-service/v1/sessions/create",e.PUT_RECORD_PLAYBACK_API_PATH="/sr-data-ingestion-service/v1/sessions/record-playback",e.POST_RECORD_PLAYBACK_API_PATH="/sr-data-ingestion-service/v1/sessions/record-playback/beacon",e.SECONDS_IN_A_DAY=86400,e.BACKOFF_SECONDS_ON_UNEXPECTED_FAILURE=60,e.PLAYBACK_DATA_INITIAL_PERSISTENCE_SECONDS=2,e.PLAYBACK_DATA_PERSISTENCE_INTERVAL_SECONDS=10,e.PLAYBACK_EVENTS_CIRCUIT_BREAKER_THRESHOLD_BYTES=1e7,e}(),L=function(e,t){return b(void 0,void 0,void 0,(function(){var n,i,s,r,o,a,c,f,p,E;return C(this,(function(I){switch(I.label){case 0:if((n=new w(e)).notAllowedToInitialize())return[2];I.label=1;case 1:return I.trys.push([1,3,,4]),[4,n.validateSession()];case 2:return I.sent(),[3,4];case 3:return i=I.sent(),t(new Error("Failed to validate session for "+e.zoneId+": "+i.toString())),[3,4];case 4:if(!n.isSessionInitialized()&&!n.doSamplingRateComparison())return n.setSampledOutBackoff(),[2];try{s=new u,r=new d,o=new h,a=new l,c=new g,f=new S,p=[s,r,o,a,c,f],n.configuration&&n.configuration.customSignal&&(E=new v(n.configuration.customSignal),p.push(E)),n.startRecording(p,t),window.QSI.SR=n}catch(n){t(new Error("Failed during startRecording of session recorder for "+e.zoneId+": "+n.toString()))}return[2]}}))}))},y=function(e){return btoa(Object(p.a)(Object(p.c)(Object(p.b)(JSON.stringify(e)),{level:9}),!0))}}}]);}catch(e){if(typeof QSI!=='undefined'&&QSI.dbg&&QSI.dbg.e){QSI.dbg.e(e);}}